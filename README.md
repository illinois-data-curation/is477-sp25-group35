# Reddit Sentiment vs. Stock Price Movement
## Link to archival record
## Contributors
*Will Baysingar
*Kareem Adi
## Summary
Overall, this project was meant test the relationship between social media posts and their short-term effect on stock prices. We decided to use Reddit posts from financial specific subreddit communities like r/wallstreetbets, r/investing, and r/stocks to see the changes in the market associated with a variety of posts made by users. This idea came to light because of the GameStop short squeeze that showed the power of social media in the market. Typically, stock prices should purely represent the total present value of all the future value of the company, but the question we are asking is whether social media can impact that intrinsic value. Our research question was known from the start and it was do Reddit posts for or against a certain stock provide insight into how the market will move in a short window. To solve this problem, we selected five large tech companies including Apple, Tesla, Amazon, Microsoft, and Google. These companies would likely give us more data in the subreddits and would have less volatility day to day allowing us to simulate an experiment easier. They trade at very high values so a change from a Reddit post would have to be significant giving us proof that there is an effect.
Next, we had to choose our data sources for to have data to test with. First, we tried to locate the Reddit data using a Reddit API, but due to circumstances regarding Reddit requiring approval to use their data we switched to a Kaggle dataset that contained metadata from Reddit. For our second data set we had planned to use Yahoo Finance through yfinance, but due to the large amount of data we were pulling from this public API our IP address was temporarily blocked. This caused us to switch our second data to pull from Alpha Vantage. While this was a large switch in the public it was a minor roadblock and fixing the Finance pulling section allowed for everything else to continue to work in succession. Once we had both of our datasets programmatically pulled into our local vs code, we implemented a pipeline to clean, merge, and analyze all the data. At the end, we implement a Snakemake workflow to ensure the project was easily reproducible. To continue, we utilized Textblob to label our Reddit posts with a sentiment value of positive, negative, or neutral and provide us with a correlation value to analyze with. We then matched the time frame of each post with the stock data and computed any possible changes, found a correlation coefficient, and graphed our findings.
To conclude the data analysis, we found that there is relatively small or no correlation between the total companies, but Microsoft and Google do show stronger correlations when analyzed on their own. However, this may be due to other circumstances like why the post was made or if the market had other trends on those dates already. A larger analysis with more data from other social media platforms would be needed to conclude for our hypothesis that there is a strong correlation.
## Data Profile 
In this project we used two datasets. Our first dataset was from Kaggle, and it included several finance subreddits posts. Our second data set we used was historical stock data for five major tech companies. For our Kaggle data set there was no author listed. Instead, the person had the username LEUKIPP and the only license for the data was to follow the license for Reddit API. After reviewing Reddit’s API license, we found that we are allowed to use the data if we mention where we got it and that it is for an educational project. Earlier in this project we were slowed down because they wanted to conduct a screening taking 1-2 months to approve projects for API Keys. Thus, we are following all necessary terms of use according to Reddit and Kaggle. In addition, the posts were selected and collected under Reddit’s public content license which means, and redistribution or analysis of the content is allowed. We used the data to find information related to our stocks of choice and used keyword matching to ensure we were only using posts relevant to our stocks of choice. After merging and filtering the posts we were left with 2,688 relevant posts.
For our second data set, we had planned to use yfinance but continued to run into rate-limit errors, so we decided to switch how we were gathering the data. We solved this problem by switching to Alpha Vantage an alternative stock price API that is free and has daily stock closing prices. We then made a script that pulled this data as a JSON file and used python to convert this data to Dataframes so we could easily reference them as CSV files. Each file for both the Reddit data and the stock data was verified using SHA-256 checksums. We coded them in allowing anyone who pulls the same exact data will be sure nothing has changed, and they will receive the same results upon running our workflow. All our data was not pushed to GitHub, instead our scripts that clean and analyze the data providing results were pushed so that the whole thing is reproducible. As for the license on Alpha Vantage, the free version allows for simple data pulling and has allowed uses for research and development purposes. Our research project fell under the allowed uses and thus this was the perfect option after our yfinance troubles. To conclude this section, we had to find the right amount of efficiency while balancing terms of use and the cost of implementing certain data sets. We used our two datasets because they had little to no restrictions, did not cost any money, and provided quick accurate data. While both datasets had licenses and rules regarding their use, school research problems were allowed on both and such they fit perfectly for our free use. In addition, both Kaggle and Alpha Vantage had Private API Keys so we will put the steps needed to gather those and run the workflow below in this report.
## Findings
Our main goal throughout the whole project was to determine correlation between social media and stock price movement. This quickly was narrowed to Reddit and specifically the wallstreetbets, investing, and stock subreddit and to five stocks: Apple, Amazon, Tesla, Microsoft, and Google. We only used Reddit posts that contained one of our five mention stocks and then we used the Textblob library to gain a correlation score between -1 and 1 and a word value of positive, negative, or neutral. We also aligned the posts with the closest stock closing price and future opening price to compute the return associated with each social media post. We then used these values and the Textblob returned numerical value to calculate correlation in a table and a graph for each individual stock and all the stocks in one graph. These were all correlation scatter plots with a line of best fit to easily see the changes. The correlation between all scores and stock return was very low at almost 0 showing that there is not a lot of predictive power when all the stocks are pooled together. This is not extremely surprising due to how large these companies are and many other factors like how many people viewed a post or if a change even happened right away. However, there is a different way to view the data and that is when each stock is individualized. The correlation values were -0.0178 for Tesla, -0.1040 for Apple, -0.0001 for Microsoft, 0.0211 for Google, and 0.0139 for Amazon. Although none of these values seem particularly large there is some power associated with Tesla. Ten percent of the variation in Tesla’s next day stock price versus the Tesla’s Day before stock price can be inversely explained by the subreddits posts in wallstreetbets, investing, and stocks. The visualizations returned that can be viewed in the Box results folder are particularly helpful in seeing the small amounts of correlation versus Apple’s large correlation. These results may not be entirely truthful when placed on a global scale, but repeating these steps with large amounts of data it may be possible to use this information for personal gain. There are plenty of ways we have seen this relationship work in the real world. The real challenge comes from predictability. If a stronger computer with large amounts of data handled the information, they might be able to find a stronger correlation and use it for investing. In addition, we used the next trading day as our tester for change but increasing this time frame or just analyzing more long-term results from certain posts could also provide a large skew in the results. To sum it all up, while our results did not have significant predictability powers, changing the data or how you analyze the data could easily change the strength of the correlation. Overall, this product shows the challenge of using a small set of data and how some projects can only be truly shown when facing an amount of data close to the population data set.
## Future Work
After completing the work for the project, it is clear a larger investigation is necessary to find a true relationship between social media and market fluctuation. We built a well-prepared reproducible script and laid out how to redo this project, but there are many areas that could be improved to get a better more reliable result for a global scale. The first topic of future work we will go over is improving the sentiment analysis. TextBlob was very useful for us as it was simple to integrate and gave a fast and mostly accurate result. However, TextBlob is for general sentiment analysis and is not programmed to search for key financial terms. Replacing this model with a more advanced one that is meant for finance and goes more in depth could easily handle the financial jargon and give more meaningful scores to each post. On top of that, there are other metrics that we could analyze when looking at Reddit posts or other social media posts. We could include a weighted analysis to have likes, shares, and views, as well as a sentiment score to see if the amount of people seeing a post is consistent with the changes. We could even begin doing a sentiment analysis on the comments to see how people reacted to these posts. The next topic that could be improved in our project is how we are timing the changes in stock prices. A post from Reddit could take several days or even weeks to reach its audience and then it could spark a change in the market. It would be important to look at larger trends in the stock data as well as trends in number of posts about a certain company to get a larger view of the changes in data. It would be interesting to see if the sheer number of posts affect the market or if the content of the posts is making most of the difference. To continue, for our analysis we used five major tech companies that were frequently prevalent in the Reddit data. We could change what companies we use or change it to market segments. In addition, adding in small cap stocks would allow us to see even more volatility. We could also continue an analysis on the difference in predictability in smaller versus larger stocks.
One important takeaway that we learned in this project is that things do not always go as planned. Our original plan had a lot of issues if we wanted to keep this project free and efficient time wise. We could not use the Reddit data due to the background they spend analyzing projects and we could not use Yahoo Finance due to the IP block after pulling small amounts of data. In the future, using a paid API key or another API key that makes pulling this data more efficient could be used to improve our project and increase the scale at which everything is done. On top of that, using large amounts of data would require a higher processing machine than a simple MacBook. Thus, with proper funding this project could easily be a huge experiment and could allow for people to analyze possible market changes and make predictions before they end up losing money or to buy a stock that may have significant mainstream profitability.
## Reproducing
To reproduce this project:
1. Clone the repository.
2. Obtain an Alpha Vantage API key and save it in a “.env” file in the root of the repository as ALPHAVANTAGE_API_KEY= “YOUR KEY”
3. Obtain a Kaggle API key and download it as Kaggle-2.json and save in in the root of the repository
4. Run pip install -r requirements.txt
5. Run the snakemake workflow
## References
Leukipp. (2023). Reddit Finance Data [Data set]. Kaggle. https://www.kaggle.com/datasets/leukipp/reddit-finance-data
Loria, S. (2022). TextBlob (Version X.X) [Source code]. GitHub. https://github.com/sloria/TextBlob
Alpha Vantage Inc. (n.d.). Alpha Vantage: Free APIs for Realtime and Historical Data. https://www.alphavantage.co/